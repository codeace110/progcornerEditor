<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kodebreakers</title>
    <script src="https://apis.google.com/js/api.js"></script>

    <link href="https://fonts.googleapis.com/css?family=Figtree:400,600&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.0-beta1/css/bootstrap.min.css"
        rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.62.2/codemirror.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.62.2/theme/dracula.min.css" rel="stylesheet">
    <link rel="stylesheet" href="index.css">
    <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-firestore.js"></script>


</head>

<body>
    <div class="top-container">
        <h1>Welcome to Kodebreakers!</h1>
        <button id="theme-toggle" class="btn">Toggle Theme</button>
        <div class="row">
            <div class="col-md-6">
                <h2>Code Editor</h2>
                <p>Enter your code in the editor below, then click the "Run" button to see the output.</p>

            </div>
            <div class="col">
                <h2>Output</h2>
                <p>The output of your code will appear in the area below.</p>
            </div>
        </div>
    </div>

    <div class="container">
        <div class="row">
            <div class="col-md-6">
                <form onsubmit="return searchVideos(event);">
                    <input type="text" id="search-input" placeholder="Search YouTube">
                    <button type="submit">Search</button>
                </form>

                <div id="video-container">
                    <iframe width="790" height="444" src="https://www.youtube.com/embed/W6NZfCO5SIk"
                        title="JavaScript Tutorial for Beginners: Learn JavaScript in 1 Hour" frameborder="0"
                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                        allowfullscreen></iframe>
                </div>

            </div>
            <div class="col">
                <div class="output-container">
                    <div id="output-container">Output will Display here!</div>
                    <div id="log-container" style="display: none;"></div>
                </div>
                <div class="container text-center">
                    <div class="row align-items-start">
                        <div class="col">
                            <button onclick="runCode()" class="btn">
                                <h1>RUN</h1>
                            </button>
                        </div>
                    </div>
                </div>
                <div class="editor-container">
                    <textarea id="editor"></textarea>
                </div>
            </div>

        </div>
    </div>

    <!-- Firebase SDK -->

    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.62.2/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.62.2/mode/javascript/javascript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.62.2/addon/edit/matchbrackets.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.62.2/addon/edit/closebrackets.min.js"></script>
    <script src="code.js"></script>
    <script src="index.js"></script>
    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyASHm4DHXPNiem2nl25_Ax8jHHXRSVYC7A",
            authDomain: "programmerscornerph-2f1f9.firebaseapp.com",
            databaseURL: "https://programmerscornerph-2f1f9-default-rtdb.firebaseio.com",
            projectId: "programmerscornerph-2f1f9",
            storageBucket: "programmerscornerph-2f1f9.appspot.com",
            messagingSenderId: "1090743775951",
            appId: "1:1090743775951:web:fb6d67af58b66fbfd8bdba",
            measurementId: "G-BT751SCDZ2"
        };
        const app = initializeApp(firebaseConfig);
        // Initialize Firestore
        var db = firebase.firestore();
    </script>
    <script>
        function searchVideos(event) {
            event.preventDefault(); // Prevent the form from submitting

            var searchInput = document.getElementById("search-input").value;
            var videoContainer = document.getElementById("video-container");

            // Query Firestore for links containing the search keyword
            db.collection("videos")
                .where("keyword", "==", searchInput)
                .get()
                .then((querySnapshot) => {
                    if (!querySnapshot.empty) {
                        // Get the first document from the query result
                        var doc = querySnapshot.docs[0];

                        // Update the iframe with the video link
                        var iframe = document.createElement("iframe");
                        iframe.src = doc.data().value;
                        iframe.width = "790";
                        iframe.height = "444";
                        iframe.frameborder = "0";
                        iframe.allow =
                            "accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share";
                        iframe.allowfullscreen = true;

                        videoContainer.innerHTML = ""; // Clear the previous video (if any)
                        videoContainer.appendChild(iframe); // Add the new video
                    } else {
                        videoContainer.innerHTML = "No videos found.";
                    }
                })
                .catch((error) => {
                    console.log(error);
                    videoContainer.innerHTML = "An error occurred while searching for videos.";
                });
        }

    </script>

</body>

</html>