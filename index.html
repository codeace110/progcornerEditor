<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kodebreakers</title>
    <script src="https://apis.google.com/js/api.js"></script>

    <link href="https://fonts.googleapis.com/css?family=Figtree:400,600&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.0-beta1/css/bootstrap.min.css"
        rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.62.2/codemirror.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.62.2/theme/dracula.min.css" rel="stylesheet">
    <link rel="stylesheet" href="index.css">
    <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-firestore.js"></script>


</head>

<body>
    <div class="top-container">
        <h1>Welcome to Kodebreakers!</h1>
        <button id="theme-toggle" class="btn">Toggle Theme</button>
        <div class="row">
            <div class="col-md-6">
                <h2>Code Editor</h2>
                <p>Enter your code in the editor below, then click the "Run" button to see the output.</p>

            </div>
            <div class="col">
                <h2>Output</h2>
                <p>The output of your code will appear in the area below.</p>
            </div>
        </div>
    </div>

    <div class="container">
        <div class="row">
            <div class="col-md-6">
                <form onsubmit="return searchVideos(event);">
                    <input type="text" id="search-input" placeholder="Search YouTube">
                    <button type="submit">Search</button>
                </form>

                <div id="video-container">
                    <iframe width="100%" height="100%" src="https://www.youtube.com/embed/W6NZfCO5SIk"
                        title="JavaScript Tutorial for Beginners: Learn JavaScript in 1 Hour" frameborder="0"
                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                        allowfullscreen></iframe>
                </div>
                <div id="pagination" style="display: flex; justify-content: center;">
                    <a href="#">Previous</a>
                    <a href="#">1</a>
                    <a href="#">2</a>
                    <a href="#">3</a>
                    <a href="#">Next</a>
                </div>
            </div>
            <div class="col">
                <div class="output-container">
                    <div id="output-container">Output will Display here!</div>
                    <div id="log-container" style="display: none;"></div>
                </div>
                <div class="container text-center">
                    <div class="row align-items-start">
                        <div class="col">
                            <button onclick="runCode()" class="btn">
                                <h1>RUN</h1>
                            </button>
                        </div>
                    </div>
                </div>
                <div class="editor-container">
                    <textarea id="editor"></textarea>
                </div>
            </div>

        </div>
    </div>

    <!-- Firebase SDK -->

    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.62.2/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.62.2/mode/javascript/javascript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.62.2/addon/edit/matchbrackets.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.62.2/addon/edit/closebrackets.min.js"></script>
    <script src="code.js"></script>
    <script src="index.js"></script>

    <script>

        const firebaseConfig = {
            apiKey: "AIzaSyASHm4DHXPNiem2nl25_Ax8jHHXRSVYC7A",
            authDomain: "programmerscornerph-2f1f9.firebaseapp.com",
            databaseURL: "https://programmerscornerph-2f1f9-default-rtdb.firebaseio.com",
            projectId: "programmerscornerph-2f1f9",
            storageBucket: "programmerscornerph-2f1f9.appspot.com",
            messagingSenderId: "1090743775951",
            appId: "1:1090743775951:web:fb6d67af58b66fbfd8bdba",
            measurementId: "G-BT751SCDZ2"
        };
        firebase.initializeApp(firebaseConfig);

        // Initialize Firestore
        const db = firebase.firestore();

        function searchVideos(event) {
            event.preventDefault(); // prevent default form submission

            const searchKeyword = document.getElementById('search-input').value;

            videosRef.get().then((doc) => {
                if (doc.exists) {
                    const videoUrl = doc.data()[searchKeyword.toLowerCase()];
                    if (videoUrl) {
                        videoContainer.innerHTML = '';
                        const video = document.createElement('iframe');
                        video.width = '100%';
                        video.height = '100%';
                        video.src = videoUrl;
                        video.title = 'YouTube video player';
                        video.frameBorder = '0';
                        video.allow = 'accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share';
                        video.allowFullscreen = true;
                        videoContainer.appendChild(video);

                        showVideos(currentVideoPage);
                    }
                }
            });
        }

        const videosPerPage = 1; // change this to set the number of videos to show per page
        const videoContainer = document.getElementById('video-container');
        const pagination = document.getElementById('pagination');
        const videosRef = db.collection('videos').doc('javascript');
        let currentVideoPage = 1;

        function showVideos(page) {
            const startIndex = (page - 1) * videosPerPage;
            const endIndex = startIndex + videosPerPage;

            videosRef.get().then((doc) => {
                if (doc.exists) {
                    const videoData = doc.data();
                    const videoKeys = Object.keys(videoData);
                    const totalPages = Math.ceil(videoKeys.length / videosPerPage);
                    const videoUrls = [];

                    // Get the URLs of the videos to show on the current page
                    for (let i = startIndex; i < endIndex && i < videoKeys.length; i++) {
                        const videoKey = videoKeys[i];
                        const videoUrl = videoData[videoKey];
                        videoUrls.push(videoUrl);
                    }

                    // Update the video container with the videos to show on the current page
                    videoContainer.innerHTML = '';
                    videoUrls.forEach((videoUrl) => {
                        const video = document.createElement('iframe');
                        video.width = '100%';
                        video.height = '100%';
                        video.src = videoUrl;
                        video.title = 'YouTube video player';
                        video.frameBorder = '0';
                        video.allow = 'accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share';
                        video.allowFullscreen = true;
                        videoContainer.appendChild(video);
                    });

                    // Update the pagination links
                    pagination.innerHTML = '';

                    if (totalPages <= 4) {
                        for (let i = 1; i <= totalPages; i++) {
                            const pageNumber = document.createElement('a');
                            pageNumber.href = '#';
                            pageNumber.innerHTML = i;
                            if (i === page) {
                                pageNumber.classList.add('active');
                            }
                            pageNumber.addEventListener('click', () => {
                                currentVideoPage = i;
                                showVideos(currentVideoPage);
                            });
                            pagination.appendChild(pageNumber);
                        }
                    } else {
                        const prevButton = document.createElement('a');
                        prevButton.href = '#';
                        prevButton.innerHTML = 'Prev';
                        prevButton.addEventListener('click', () => {
                            currentVideoPage = currentVideoPage - 1;
                            showVideos(currentVideoPage);
                        });
                        pagination.appendChild(prevButton);

                        const firstPage = Math.max(1, currentVideoPage - 2);
                        const lastPage = Math.min(totalPages, currentVideoPage + 2);

                        for (let i = firstPage; i <= lastPage; i++) {
                            const pageNumber = document.createElement('a');
                            pageNumber.href = '#';
                            pageNumber.innerHTML = i;
                            if (i === currentVideoPage) {
                                pageNumber.classList.add('active');
                            }
                            pageNumber.addEventListener('click', () => {
                                currentVideoPage = i;
                                showVideos(currentVideoPage);
                            });
                            pagination.appendChild(pageNumber);
                        }

                        if (currentVideoPage < totalPages) {
                            const nextButton = document.createElement('a');
                            nextButton.href = '#';
                            nextButton.innerHTML = 'Next';
                            nextButton.addEventListener('click', () => {
                                currentVideoPage = currentVideoPage + 1;
                                showVideos(currentVideoPage);
                            });
                            pagination.appendChild(nextButton);
                        } else {
                            const nextButton = document.createElement('a');
                            nextButton.href = '#';
                            nextButton.innerHTML = 'Next';
                            nextButton.classList.add('disabled');
                         
                            pagination.appendChild(nextButton);
                            
                        }


                    }

                }
            });
        }

        showVideos(currentVideoPage);





    </script>


</body>

</html>